(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["promoter-index"],{"4a34":function(e,t,a){"use strict";a("e741")},8236:function(e,t,a){"use strict";a("61d9"),a("4822"),a("f667"),a("e7a8");t["a"]={data:function(){},methods:{replaceQuery:function(){var e=Object.assign({},this.$route.query,this.form);this.$router.replace({query:e})},getQuery:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["page"],t=this.$route.query;return Object.keys(t).forEach((function(a){for(var l=0;l<e.length;l++)e[l]===a&&(isNaN(t[a])?t[a]=1:t[a]=parseInt(t[a]))})),Object.assign(this.form,t)},emptyStatus:function(){this.$router.replace({query:{}})}},filters:{}}},"86c3":function(e,t,a){"use strict";a.r(t);var l=a("1696"),o=a("4d63"),r=a("4c02"),n=a.n(r),s=(a("61d9"),a("877e"),a("e939"),a("5d63"),a("2e9c"),a("dc87"),a("8236"));function i(e){return{data:function(){return{show:!1}},computed:{},props:e.props,render:function(t){return t(e,{on:this.$listeners,attrs:this.$attrs,props:this.$props})}}}var u,c,m,p,f=a("8121"),d=a("8572"),h=a("0e28"),b={name:"add-distributor",props:{value:{type:Boolean,default:!0}},data:function(){return{levelList:[],form:{UID:"",level:null,mobile:"",realname:"",search:""},rules:{search:[{required:!0,message:"请输入ID/昵称搜索"}],level:[{required:!0,message:"请选择分销商等级"}]},loading:!1,timeout:null}},computed:{showDialog:{get:function(e){var t=e.value;return t},set:function(e){this.$emit("input",e)}}},render:function(){var e=this,t=arguments[0],a=this;return t("el-dialog",n()([{class:"le-form",attrs:{visible:a.showDialog,title:"添加分销商",width:"496px"}},{on:Object(l["a"])({},"update:visible",(function(e){a.showDialog=e}))}]),[t("el-form",n()([{},{props:{model:a.form,rules:a.rules}},{ref:"form",attrs:{"label-width":"136px"},directives:[{name:"loading",value:a.loading}]}]),[t("el-form-item",{attrs:{label:"用户搜索",prop:"search"}},[t("el-autocomplete",{attrs:{"fetch-suggestions":a.querySearchAsync,placeholder:"请输入ID/昵称搜索"},class:"le-input--240",on:{select:a.handleSelect},scopedSlots:{default:function(e){var a=e.item;return t("div",{class:"flex justify-between"},[t("span",[a.nickname]),t("span",["ID:",a.id])])}},model:{value:a.form.search,callback:function(t){e.$set(a.form,"search",t)}}})]),t("el-form-item",{attrs:{label:"分销商等级",prop:"level"}},[t("el-select",{class:"le-input--240",model:{value:a.form.level,callback:function(t){e.$set(a.form,"level",t)}}},[a.levelList.map((function(e,a){return t("el-option",{key:a,attrs:{label:e.name,value:e.level}})}))])]),t("el-form-item",{attrs:{label:"姓名"}},[t("el-input",{class:"le-input--240",attrs:{placeholder:"请输入姓名"},model:{value:a.form.realname,callback:function(t){e.$set(a.form,"realname",t)}}})]),t("el-form-item",{attrs:{label:"手机号"}},[t("el-input",{class:"le-input--240",attrs:{placeholder:"请输入手机号"},model:{value:a.form.mobile,callback:function(t){e.$set(a.form,"mobile",t)}}})])]),t("div",{slot:"footer"},[t("el-button",{on:{click:function(){return a.showDialog=!1}}},["取消"]),t("el-button",{attrs:{type:"primary"},on:{click:a.submit}},["添加"])])])},mounted:function(){var e=this;Object(h["w"])().then((function(t){e.levelList=t}))},methods:{submit:function(){var e=this;this.$refs["form"].validate((function(t){if(!t)return!1;Object(h["a"])(e.form).then((function(){e.$emit("confirm"),e.showDialog=!1,e.$message.success("添加分销商成功")})).catch((function(){}))}))},querySearchAsync:function(e,t){var a=this;e?Object(h["K"])(e).then((function(e){e=e.map((function(e){return Object(o["a"])(Object(o["a"])({},e),{},{value:e.nickname})})),e.length?t(e):a.$message({type:"info",message:"不存在该用户"})})):t()},handleSelect:function(e){console.log(e),this.form.UID=e.id}}},v=b,g=(a("a361"),a("cba8")),w=Object(g["a"])(v,u,c,!1,null,"470ae754",null),y=w.exports,_={mixins:[s["a"]],components:{agreeRefuseApply:f["a"],clearOut:d["a"],addDistributor:i(y)},data:function(){return{form:{source:"",level:0,status:"",apply_time:[],join_time:[],search:"",page:1,invite:"",sort:{apply_time:"DESC"}},page:{size:10},levelList:[],list:[],showAgreeRefuse:!1,agreeRefuseInfo:{},agreeRefuseType:"",showClearOut:!1,clearOutInfo:{},showAddDistributor:!1}},render:function(){var e=this,t=arguments[0],a=this;return t("div",{class:"le-main"},[t("el-button",{attrs:{type:"primary"},on:{click:function(){return a.showAddDistributor=!0}}},["添加分销商"]),t("el-form",n()([{},{props:{model:a.form}},{class:"le-card",attrs:{inline:!0,"label-width":"125px"}}]),[t("el-form-item",{attrs:{label:"分销商搜索"}},[t("el-input",{attrs:{value:a.form.search,placeholder:"输入ID/昵称/姓名/手机号搜索"},on:{input:function(e){a.form.search=e}},model:{value:a.form.search,callback:function(t){e.$set(a.form,"search",t)}}})]),t("el-form-item",{attrs:{label:"邀请方搜索"}},[t("el-input",{attrs:{value:a.form.invite,placeholder:"输入昵称搜索"},on:{input:function(e){a.form.invite=e}}})]),t("el-form-item",{attrs:{label:"分销商等级"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:a.form.level,callback:function(t){e.$set(a.form,"level",t)}}},[t("el-option",{attrs:{label:"全部",value:0}}),a.levelList.map((function(e,a){return t("el-option",{key:a,attrs:{label:e.name,value:e.level}})}))])]),t("el-form-item",{attrs:{label:"用户来源"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:a.form.source,callback:function(t){e.$set(a.form,"source",t)}}},[t("el-option",{attrs:{label:"全部",value:""}}),t("el-option",{attrs:{label:"微信小程序",value:"weapp"}}),t("el-option",{attrs:{label:"公众号",value:"wechat"}})])]),t("el-form-item",{attrs:{label:"状态"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:a.form.status,callback:function(t){e.$set(a.form,"status",t)}}},[t("el-option",{attrs:{label:"全部",value:""}}),t("el-option",{attrs:{label:"待审核",value:1}}),t("el-option",{attrs:{label:"已通过",value:2}}),t("el-option",{attrs:{label:"已拒绝",value:3}}),t("el-option",{attrs:{label:"已清退",value:4}})])]),t("el-form-item",{attrs:{label:"申请时间"}},[t("el-date-picker",{attrs:{size:"small",type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:a.form.apply_time,callback:function(t){e.$set(a.form,"apply_time",t)}}})]),t("el-form-item",{attrs:{label:"加入时间"}},[t("el-date-picker",{attrs:{size:"small",type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:a.form.join_time,callback:function(t){e.$set(a.form,"join_time",t)}}})]),t("div",{class:"le-button"},[t("el-button",{attrs:{type:"primary"},on:{click:a.filter}},["筛选"]),t("el-button",{on:{click:a.empty}},["清空"])])]),t("div",{class:"le-card le-table"},[t("el-table",n()([{on:Object(o["a"])({},{"sort-change":a.sortList})},{props:{data:this.list}},{attrs:{"default-sort":{prop:"apply_time",order:"descending"},"row-class-name":"le-table-row"}}]),[t("el-table-column",{attrs:{label:"基本信息",width:"288px",fixed:"left"},scopedSlots:{default:function(e){return t("div",{attrs:{"slot-scope":"scope"},class:"flex"},[t("div",[t("el-avatar",{attrs:{size:48,error:function(){return!0}}},[t("img",{attrs:{src:e.row.avatar}})])]),t("div",{class:"le-usercontent"},[t("div",{class:"le-user"},[t("i",{class:"le-icon le-icon-".concat("weapp"===e.row.type?"xiaochengxu":"wehcat")}),t("span",{class:"le-username"},[e.row.nickname])]),t("div",{class:"le-userinfor"},["ID:",e.row.UID,t("br"),e.row.realname,t("br"),e.row.mobile])])])}}}),t("el-table-column",{attrs:{label:"分销商等级"},scopedSlots:{default:function(e){return 2===e.row.status?e.row.level_name:"--"}}}),t("el-table-column",{attrs:{label:"邀请方"},scopedSlots:{default:function(e){return e.row.invite_nickname?e.row.invite_nickname:"--"}}}),t("el-table-column",{attrs:{label:"累计销售金额(元)",sortable:"custom","min-width":"140px",prop:"sales_amount"},scopedSlots:{default:function(e){return 2===e.row.status||e.row.repel_time?e.row.sales_amount:"--"}}}),t("el-table-column",{attrs:{label:"累计佣金(元)",sortable:"custom",prop:"all_commission_amount","min-width":"120px"},scopedSlots:{default:function(e){return 2===e.row.status||e.row.repel_time?e.row.all_commission_amount:"--"}}}),t("el-table-column",{attrs:{label:"当前下线数",prop:"all_children",sortable:"custom","min-width":"120px"},scopedSlots:{default:function(e){return 2===e.row.status?e.row.all_children:"--"}}}),t("el-table-column",{attrs:{label:"累计邀请分销商",sortable:"custom",prop:"invite_number","min-width":"130px"},scopedSlots:{default:function(e){return 2===e.row.status?e.row.invite_number:"--"}}}),t("el-table-column",{attrs:{label:"状态","min-width":"100px"},scopedSlots:{default:function(e){var a=e.row.status;return t("el-tag",{attrs:{effect:"plain",size:"medium",type:2===a?"success":1===a?"warning":3===a?"danger":4===a||-2===a?"info":""}},[2===a?"已通过":1===a?"待审核":3===a?"已拒绝":4===a||-2===a?"已清退":""])}}}),t("el-table-column",{attrs:{label:"时间",sortable:"custom",prop:"apply_time","min-width":"180px"},scopedSlots:{default:function(e){var l=e.row.apply_time?a.$moment(new Date(1e3*e.row.apply_time)).format("Y-MM-DD HH:mm:ss"):"--",o=e.row.join_time?a.$moment(new Date(1e3*e.row.join_time)).format("Y-MM-DD HH:mm:ss"):"--";return t("span",["申请：",l,function(){if(2===e.row.status)return[[t("br")],["加入：".concat(o)]]}()])}}}),t("el-table-column",{attrs:{label:"操作","min-width":"220px"},scopedSlots:{default:function(e){return t("div",{class:"le-table-operate flex align-center"},[function(){if(e.row.repel_time||2===e.row.status)return[[t("el-button",{attrs:{type:"text"},on:{click:a.routerDetail.bind(a,e.row.UID)}},["详情"])]]}(),function(){return 2===e.row.status?[[t("span",{class:"le-line"})],[t("el-button",{on:{click:a.clearOut.bind(a,e.row)},attrs:{type:"text"}},["清退"])]]:1===e.row.status?[[t("el-button",{attrs:{type:"text"},on:{click:a.agreeRefuse.bind(a,e.row,"pass")}},["通过"])],[t("span",{class:"le-line"})],[t("el-button",{attrs:{type:"text"},on:{click:a.agreeRefuse.bind(a,e.row,"refuse")}},["拒绝"])]]:void 0}()])}}})]),t("div",{class:"flex le-pagination justify-end"},[t("el-pagination",{attrs:{background:!0,"current-page":a.form.page,layout:"prev, pager, next, jumper","page-count":a.page.count},on:{"current-change":a.switchPage}})])]),function(){if(a.showAgreeRefuse)return t(f["a"],{attrs:{type:a.agreeRefuseType,info:a.agreeRefuseInfo},model:{value:a.showAgreeRefuse,callback:function(t){e.$set(a,"showAgreeRefuse",t)}}})}(),function(){if(a.showClearOut)return t(d["a"],{attrs:{info:a.clearOutInfo},model:{value:a.showClearOut,callback:function(t){e.$set(a,"showClearOut",t)}}})}(),t("addDistributor",{on:{confirm:function(){a.getList()}},model:{value:a.showAddDistributor,callback:function(t){e.$set(a,"showAddDistributor",t)}}})])},mounted:function(){this.getLevel(),this.getList()},methods:{routerDetail:function(e){this.$router.push({path:"/promoter/index-detail/"+e})},switchPage:function(e){this.form.page=e,this.getList()},filter:function(){this.getList()},empty:function(){this.form={source:"",level:0,status:"",apply_time:[],join_time:[],search:"",page:1,invite:"",sort:this.form.sort},this.filter()},getParseInt:function(e){return isNaN(e)?0:parseInt(e)},sortList:function(e){this.form.sort=Object(l["a"])({},e.prop,"descending"===e.order?"DESC":"ASC"),this.getList()},getList:function(){var e,t,a=this,l=this.$_.cloneDeep(this.form);null!==(e=l.apply_time)&&void 0!==e&&e.length?(l.apply_time_start=l.apply_time[0]/1e3,l.apply_time_end=l.apply_time[1]/1e3):(l.apply_time_start=0,l.apply_time_end=0),null!==(t=l.join_time)&&void 0!==t&&t.length?(l.join_time_start=l.join_time[0]/1e3,l.join_time_end=l.join_time[1]/1e3):(l.join_time_start=0,l.join_time_end=0),delete l.apply_time,delete l.join_time,this.$heshop.search("post",{include:"promoter"},{keyword:l}).page(this.form.page,this.page.size).then((function(e){var t=e.data,l=e.headers;a.list=t,a.form.page=+l["x-pagination-current-page"],a.page={count:+l["x-pagination-page-count"],size:+l["x-pagination-per-page"],total:+l["x-pagination-total-count"]}})).catch((function(e){a.$message.error(e.data.message)}))},getLevel:function(){var e=this;this.$heshop.promoterlevel("get").then((function(t){e.levelList=t})).catch((function(t){e.$message.error(t.data.message)}))},agreeRefuse:function(e,t){this.showAgreeRefuse=!0,this.agreeRefuseInfo=e,this.agreeRefuseType=t},clearOut:function(e){this.showClearOut=!0,this.clearOutInfo=e}},beforeRouteEnter:function(e,t,a){console.log("路由进入"),a()},watch:{$route:{handler:function(e){console.log(e)},deep:!0,immediate:!0}}},k=_,$=(a("4a34"),Object(g["a"])(k,m,p,!1,null,"48940f26",null));t["default"]=$.exports},a361:function(e,t,a){"use strict";a("db98")},db98:function(e,t,a){},e741:function(e,t,a){}}]);
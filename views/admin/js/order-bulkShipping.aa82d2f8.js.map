{"version":3,"sources":["webpack:///./src/pages/order/bulkShipping.vue?6dff","webpack:///src/pages/order/bulkShipping.vue","webpack:///./src/pages/order/bulkShipping.vue?dac6","webpack:///./src/pages/order/bulkShipping.vue","webpack:///./src/pages/order/bulkShipping.vue?2904"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","form","rules","nativeOn","$event","preventDefault","_v","on","changeRadio","model","value","callback","$$v","$set","expression","staticStyle","type","origin","bulkShipping","ref","upload","_e","getAddress","_l","item","index","key","label","addressList","length","style","radio","id","_s","name","province","city","district","address","mobile","downloadFile","logistics_company","time_start","time_end","getSearch","empty","list","scopedSlots","_u","fn","scope","row","handle_sn","order_number","success_number","_f","created_time","exportData","page","current","count","currentChange","loading","dialogVisible","dialogType","slot","staticRenderFns","components","heLoading","data","size","express","copyData","methods","e","getList","$refs","click","uploadWaybill","time","Date","getTime","toString","substr","$heshop","files","readExcel","console","log","fileReader","onload","ws","forEach","push","_this","postBody","waybill_id","$message","error","readAsBinaryString","$_","cloneDeep","i","trim","code","a","setAttribute","mounted","window","location","component"],"mappings":"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","file":"js/order-bulkShipping.aa82d2f8.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-form',{staticClass:\"le-matter\",attrs:{\"label-width\":\"120px\",\"model\":_vm.form,\"rules\":_vm.rules},nativeOn:{\"submit\":function($event){$event.preventDefault();}}},[_c('div',{staticClass:\"le-announcement\"},[_vm._v(\" 批量发货注意事项： \"),_c('br'),_vm._v(\" 1. 请先按照模板填写订单号、物流公司、物流单号信息。物流单号不可写成E+22的科学计数法\"),_c('br'),_vm._v(\" 2. 未成功发货的订单，可下载【失败记录】查看详细的失败原因，对症修改\"),_c('br'),_vm._v(\" 3. 发货订单数据，最大不超过1000条（支持csv、xls、xlsx，文件大小请控制在2MB以内）\"),_c('br'),_vm._v(\" 4. 物流公司名称，请填写全称，如圆通速递，不可填写为圆通\"),_c('br')]),_c('div',{staticClass:\"le-header le-card\"},[_c('el-form-item',{attrs:{\"label\":\"批量发货类型\"}},[_c('el-radio-group',{on:{\"change\":_vm.changeRadio},model:{value:(_vm.form.type),callback:function ($$v) {_vm.$set(_vm.form, \"type\", $$v)},expression:\"form.type\"}},[_c('el-radio',{attrs:{\"label\":1}},[_vm._v(\"手动填写物流信息（传统模式）\")]),_c('el-radio',{attrs:{\"label\":2}},[_vm._v(\"自动获取电子面单\")])],1),_c('div',{staticClass:\"le-prompt-text\"},[_vm._v(\" 选择自动获取电子面单，则发货模板中 \"),_c('span',{staticStyle:{\"color\":\"#262626\"}},[_vm._v(\"仅需要填写订单号\")]),_vm._v(\"，快递单号将自动获取 \")]),(_vm.form.type === 1)?_c('div',{staticClass:\"le-editor\"},[_c('el-button',{staticClass:\"le-button le-text\",attrs:{\"plain\":\"\"}},[_c('a',{attrs:{\"href\":_vm.origin + '/static/files/bulk-shipping-template.xlsx',\"download\":\"批量发货模板.xlsx\"}},[_vm._v(\"下载批量发货模板\")])]),_c('button',{staticClass:\"le-button le-default\",on:{\"click\":_vm.bulkShipping}},[_vm._v(\"批量发货\")]),_c('input',{ref:\"upload\",staticStyle:{\"display\":\"none\"},attrs:{\"type\":\"file\",\"accept\":\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,.csv,application/vnd.ms-excel\"},on:{\"change\":_vm.upload}})],1):_vm._e()],1),(_vm.form.type === 2)?_c('el-form-item',{attrs:{\"label\":\"物流公司\",\"prop\":\"logistics_company\"}},[_c('el-select',{attrs:{\"placeholder\":\"请选择物流公司\"},on:{\"change\":_vm.getAddress},model:{value:(_vm.form.logistics_company),callback:function ($$v) {_vm.$set(_vm.form, \"logistics_company\", $$v)},expression:\"form.logistics_company\"}},_vm._l((_vm.express),function(item,index){return _c('el-option',{key:index,attrs:{\"label\":item.label,\"value\":item.value}})}),1)],1):_vm._e(),(_vm.form.type === 2 && _vm.addressList.length > 0)?_c('el-form-item',{attrs:{\"label\":\"发货地址\",\"prop\":\"radio\"}},[_c('el-scrollbar',{staticClass:\"he-address\"},_vm._l((_vm.addressList),function(item,index){return _c('div',{key:index,staticClass:\"he-address__item\"},[_c('el-radio',{style:(_vm.form.radio === item.id ? 'background: rgba(98, 60, 235, 0.1);' : ''),attrs:{\"label\":item.id,\"border\":\"\"},model:{value:(_vm.form.radio),callback:function ($$v) {_vm.$set(_vm.form, \"radio\", $$v)},expression:\"form.radio\"}},[_vm._v(\" (\"+_vm._s(item.name)+\" 发) \"+_vm._s(item.province)+_vm._s(item.city)+_vm._s(item.district)+_vm._s(item.address)+\" \"+_vm._s(item.mobile))])],1)}),0)],1):_vm._e(),(_vm.form.type === 2)?_c('el-form-item',{staticClass:\"le-editor\",attrs:{\"label\":\"\"}},[_c('el-button',{attrs:{\"plain\":\"\",\"disabled\":!_vm.form.radio},on:{\"click\":_vm.downloadFile}},[_vm._v(\" 下载批量发货模板 \")]),_c('el-button',{staticClass:\"le-waybill--btn\",attrs:{\"type\":\"primary\",\"disabled\":!_vm.form.logistics_company || !_vm.form.radio},on:{\"click\":_vm.bulkShipping}},[_vm._v(\"批量发货\")]),_c('input',{ref:\"uploadWaybill\",staticStyle:{\"display\":\"none\"},attrs:{\"type\":\"file\",\"accept\":\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,.csv,application/vnd.ms-excel\"},on:{\"change\":_vm.upload}})],1):_vm._e()],1),_c('div',{staticClass:\"le-search le-card\"},[_c('span',{staticClass:\"le-label\"},[_vm._v(\"发货时间\")]),_c('el-date-picker',{staticClass:\"le-search-date\",attrs:{\"type\":\"datetime\",\"placeholder\":\"开始日期\"},model:{value:(_vm.time_start),callback:function ($$v) {_vm.time_start=$$v},expression:\"time_start\"}}),_c('span',{staticClass:\"le-label\"},[_vm._v(\"至\")]),_c('el-date-picker',{staticClass:\"le-search-date\",attrs:{\"type\":\"datetime\",\"placeholder\":\"结束日期\"},model:{value:(_vm.time_end),callback:function ($$v) {_vm.time_end=$$v},expression:\"time_end\"}}),_c('div',{staticClass:\"le-editor\"},[_c('button',{staticClass:\"le-button le-default\",on:{\"click\":_vm.getSearch}},[_vm._v(\"筛选\")]),_c('el-button',{staticStyle:{\"margin-left\":\"10px\"},on:{\"click\":_vm.empty}},[_vm._v(\"清空\")])],1)],1),_c('div',{staticClass:\"le-body le-card\"},[_c('el-table',{staticClass:\"le-table\",attrs:{\"row-class-name\":\"le-table-row\",\"height\":\"680\",\"data\":_vm.list}},[_c('el-table-column',{attrs:{\"label\":\"发货编号\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(\" \"+_vm._s(scope.row.handle_sn)+\" \")]}}])}),_c('el-table-column',{attrs:{\"label\":\"发货订单数\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(\" \"+_vm._s(scope.row.order_number)+\" \")]}}])}),_c('el-table-column',{attrs:{\"label\":\"成功发货订单数\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(\" \"+_vm._s(scope.row.success_number)+\" \")]}}])}),_c('el-table-column',{attrs:{\"label\":\"操作时间\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(_vm._s(_vm._f(\"timeFormat\")(scope.row.created_time,'yyyy-mm-dd hh:MM:ss'))+\" \")]}}])}),_c('el-table-column',{attrs:{\"label\":\"操作\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [(scope.row.order_number !== scope.row.success_number)?_c('button',{staticClass:\"le-button le-text le-table--operating__btn\",on:{\"click\":function($event){return _vm.exportData(scope.row.id)}}},[_vm._v(\" 失败记录 \")]):[_vm._v(\" — — \")]]}}])})],1),_c('div',{staticClass:\"le-pagination flex justify-end align-center\"},[_c('el-pagination',{attrs:{\"background\":\"\",\"layout\":\"prev, pager, next, jumper\",\"current-page\":_vm.page.current,\"page-count\":_vm.page.count},on:{\"current-change\":_vm.currentChange}})],1)],1),_c('he-loading',{attrs:{\"title\":\"文件上传处理中，请稍后...\",\"show\":_vm.loading}}),_c('el-dialog',{attrs:{\"visible\":_vm.dialogVisible,\"width\":\"30%\",\"top\":\"35vh\"},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('div',{staticStyle:{\"text-align\":\"center\",\"margin-top\":\"43px\"}},[_c('i',{staticClass:\"le-icon le-icon-zhushi\"}),_c('div',{staticClass:\"le-dialog-text\"},[_vm._v(\" \"+_vm._s(_vm.dialogType === 1 ? '文件格式错误，请使用csv、xls、xlsx的格式文件' : _vm.dialogType === 2 ? '文件大小超过2MB，请压缩或删减内容后上传' : '订单数据量超过1000条，请删减后分多次上传')+\" \")])]),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.dialogVisible = false}}},[_vm._v(\"重新上传\")])],1)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <el-form class=\"le-matter\" label-width=\"120px\" :model=\"form\" :rules=\"rules\" @submit.native.prevent>\n    <div class=\"le-announcement\">\n      批量发货注意事项： <br />\n      1. 请先按照模板填写订单号、物流公司、物流单号信息。物流单号不可写成E+22的科学计数法<br />\n      2. 未成功发货的订单，可下载【失败记录】查看详细的失败原因，对症修改<br />\n      3. 发货订单数据，最大不超过1000条（支持csv、xls、xlsx，文件大小请控制在2MB以内）<br />\n      4. 物流公司名称，请填写全称，如圆通速递，不可填写为圆通<br />\n    </div>\n    <div class=\"le-header le-card\">\n      <el-form-item label=\"批量发货类型\">\n        <el-radio-group v-model=\"form.type\" @change=\"changeRadio\">\n          <el-radio :label=\"1\">手动填写物流信息（传统模式）</el-radio>\n          <el-radio :label=\"2\">自动获取电子面单</el-radio>\n        </el-radio-group>\n        <div class=\"le-prompt-text\">\n          选择自动获取电子面单，则发货模板中\n          <span style=\"color: #262626\">仅需要填写订单号</span>，快递单号将自动获取\n        </div>\n        <div class=\"le-editor\" v-if=\"form.type === 1\">\n          <el-button class=\"le-button le-text\" plain>\n            <a :href=\"origin + '/static/files/bulk-shipping-template.xlsx'\" download=\"批量发货模板.xlsx\"\n              >下载批量发货模板</a\n            >\n          </el-button>\n          <button class=\"le-button le-default\" @click=\"bulkShipping\">批量发货</button>\n          <input\n            ref=\"upload\"\n            type=\"file\"\n            style=\"display: none\"\n            accept=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,.csv,application/vnd.ms-excel\"\n            @change=\"upload\"\n          />\n        </div>\n      </el-form-item>\n      <el-form-item label=\"物流公司\" prop=\"logistics_company\" v-if=\"form.type === 2\">\n        <el-select placeholder=\"请选择物流公司\" v-model=\"form.logistics_company\" @change=\"getAddress\">\n          <el-option v-for=\"(item, index) in express\" :key=\"index\" :label=\"item.label\" :value=\"item.value\"> </el-option>\n        </el-select>\n      </el-form-item>\n      <el-form-item label=\"发货地址\" prop=\"radio\" v-if=\"form.type === 2 && addressList.length > 0\">\n        <el-scrollbar class=\"he-address\">\n          <div v-for=\"(item, index) in addressList\" :key=\"index\" class=\"he-address__item\">\n            <el-radio\n              v-model=\"form.radio\"\n              :style=\"form.radio === item.id ? 'background: rgba(98, 60, 235, 0.1);' : ''\"\n              :label=\"item.id\"\n              border\n            >\n              ({{ item.name }} 发) {{ item.province }}{{ item.city }}{{ item.district }}{{ item.address }}\n              {{ item.mobile }}</el-radio\n            >\n          </div>\n        </el-scrollbar>\n      </el-form-item>\n      <el-form-item label=\"\" class=\"le-editor\" v-if=\"form.type === 2\">\n        <el-button plain :disabled=\"!form.radio\" @click=\"downloadFile\"> 下载批量发货模板 </el-button>\n        <el-button\n          class=\"le-waybill--btn\"\n          type=\"primary\"\n          @click=\"bulkShipping\"\n          :disabled=\"!form.logistics_company || !form.radio\"\n          >批量发货</el-button\n        >\n        <input\n          ref=\"uploadWaybill\"\n          type=\"file\"\n          style=\"display: none\"\n          accept=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,.csv,application/vnd.ms-excel\"\n          @change=\"upload\"\n        />\n      </el-form-item>\n    </div>\n    <div class=\"le-search le-card\">\n      <span class=\"le-label\">发货时间</span>\n      <el-date-picker class=\"le-search-date\" v-model=\"time_start\" type=\"datetime\" placeholder=\"开始日期\">\n      </el-date-picker>\n      <span class=\"le-label\">至</span>\n      <el-date-picker class=\"le-search-date\" v-model=\"time_end\" type=\"datetime\" placeholder=\"结束日期\">\n      </el-date-picker>\n      <div class=\"le-editor\">\n        <button class=\"le-button le-default\" @click=\"getSearch\">筛选</button>\n        <el-button @click=\"empty\" style=\"margin-left: 10px\">清空</el-button>\n      </div>\n    </div>\n    <div class=\"le-body le-card\">\n      <el-table class=\"le-table\" row-class-name=\"le-table-row\" height=\"680\" :data=\"list\">\n        <el-table-column label=\"发货编号\">\n          <template slot-scope=\"scope\">\n            {{ scope.row.handle_sn }}\n          </template>\n        </el-table-column>\n        <el-table-column label=\"发货订单数\">\n          <template slot-scope=\"scope\">\n            {{ scope.row.order_number }}\n          </template>\n        </el-table-column>\n        <el-table-column label=\"成功发货订单数\">\n          <template slot-scope=\"scope\">\n            {{ scope.row.success_number }}\n          </template>\n        </el-table-column>\n        <el-table-column label=\"操作时间\">\n          <template slot-scope=\"scope\">{{ scope.row.created_time | timeFormat('yyyy-mm-dd hh:MM:ss') }} </template>\n        </el-table-column>\n        <el-table-column label=\"操作\">\n          <template slot-scope=\"scope\">\n            <button\n              v-if=\"scope.row.order_number !== scope.row.success_number\"\n              class=\"le-button le-text le-table--operating__btn\"\n              @click=\"exportData(scope.row.id)\"\n            >\n              失败记录\n            </button>\n            <template v-else> — — </template>\n          </template>\n        </el-table-column>\n      </el-table>\n      <div class=\"le-pagination flex justify-end align-center\">\n        <el-pagination\n          background\n          layout=\"prev, pager, next, jumper\"\n          @current-change=\"currentChange\"\n          :current-page=\"page.current\"\n          :page-count=\"page.count\"\n        >\n        </el-pagination>\n      </div>\n    </div>\n    <he-loading title=\"文件上传处理中，请稍后...\" :show=\"loading\"></he-loading>\n    <el-dialog :visible.sync=\"dialogVisible\" width=\"30%\" top=\"35vh\">\n      <div style=\"text-align: center; margin-top: 43px\">\n        <i class=\"le-icon le-icon-zhushi\"></i>\n        <div class=\"le-dialog-text\">\n          {{\n            dialogType === 1\n              ? '文件格式错误，请使用csv、xls、xlsx的格式文件'\n              : dialogType === 2\n              ? '文件大小超过2MB，请压缩或删减内容后上传'\n              : '订单数据量超过1000条，请删减后分多次上传'\n          }}\n        </div>\n      </div>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button type=\"primary\" @click=\"dialogVisible = false\">重新上传</el-button>\n      </span>\n    </el-dialog>\n  </el-form>\n</template>\n<script>\nimport heLoading from '../../components/heloading2.vue';\nimport XLSX from 'xlsx';\n\nexport default {\n  name: 'bulkShipping',\n  components: {\n    heLoading\n  },\n  data() {\n    return {\n      origin: '',\n      list: [],\n      time_start: '',\n      time_end: '',\n      loading: false,\n      page: {\n        size: 20,\n        current: 1,\n        count: 1\n      },\n      dialogVisible: false,\n      dialogType: 1,\n      form: {\n        radio: null,\n        logistics_company: '',\n        type: 1\n      },\n      express: [],\n      addressList: [],\n      copyData: {},\n      rules: {\n        logistics_company: [\n          {\n            required: true,\n            message: '物流公司不能为空'\n          }\n        ],\n        radio: [\n          {\n            required: true,\n            message: '发货地址不能为空'\n          }\n        ]\n      }\n    };\n  },\n  methods: {\n    currentChange: function (e) {\n      this.page.current = e;\n      this.getList();\n    },\n    bulkShipping: function () {\n      if (this.form.type === 1) {\n        this.$refs.upload.click();\n      } else {\n        if (!this.form.logistics_company || !this.form.radio) return;\n        this.$refs.uploadWaybill.click();\n      }\n    },\n    getSearch() {\n      this.page.current = 1;\n      this.getList();\n    },\n    empty() {\n      this.time_start = '';\n      this.time_end = '';\n      this.page.current = 1;\n      this.getList();\n    },\n    getList: function () {\n      let time = {};\n      if (this.time_start) {\n        time.time_start = new Date(this.time_start).getTime().toString().substr(0, 10);\n      }\n      if (this.time_end) {\n        time.time_end = new Date(this.time_end).getTime().toString().substr(0, 10);\n      }\n      this.$heshop\n        .orderhandle('get', time)\n        .page(this.page.current, this.page.size)\n        .then(res => {\n          let { data, headers } = res;\n          this.list = data;\n          this.page = {\n            current: +headers['x-pagination-current-page'],\n            count: +headers['x-pagination-page-count'],\n            size: +headers['x-pagination-per-page'],\n            total: +headers['x-pagination-total-count']\n          };\n        })\n        .catch(() => {\n          this.$message.error('获取失败');\n        });\n    },\n    upload() {\n      let files = null;\n      if (this.form.type === 1) {\n        files = this.$refs.upload.files;\n      } else {\n        files = this.$refs.uploadWaybill.files;\n      }\n      this.readExcel(files);\n    },\n    readExcel(files) {\n      // 表格导入\n      let _this = this;\n      if (files.length <= 0) {\n        // 如果没有文件名\n        return false;\n      } else if (!/\\.(csv|xls|xlsx)$/.test(files[0].name.toLowerCase())) {\n        this.dialogVisible = true;\n        this.dialogType = 1;\n        return false;\n      } else if (files[0].size / 1024 / 1024 > 2) {\n        console.log(files[0].size);\n        this.dialogVisible = true;\n        this.dialogType = 2;\n        return false;\n      }\n\n      this.loading = true;\n      const fileReader = new FileReader();\n      fileReader.onload = ev => {\n        try {\n          const data = ev.target.result;\n          const workbook = XLSX.read(data, {\n            type: 'binary'\n          });\n          const wsname = workbook.SheetNames[0]; // 取第一张表\n          const ws = XLSX.utils.sheet_to_json(workbook.Sheets[wsname]); // 生成json表格内容\n          let list = [];\n          if (list.length > 1000) {\n            this.dialogVisible = true;\n            this.dialogType = 3;\n            return false;\n          }\n          ws.forEach(v => {\n            if (this.form.type === 1) {\n              list.push([v['订单号'] ?? '', v['物流公司'] ?? '', v['物流单号'] ?? '']);\n            } else {\n              list.push([v['订单号'] ?? '']);\n            }\n          });\n          if (this.form.type === 1) {\n            _this.$heshop\n              .orderhandle('post', list)\n              .then(() => {\n                _this.$message.success('操作成功');\n                _this.loading = false;\n                _this.getList();\n              })\n              .catch(err => {\n                console.error(err);\n                _this.loading = false;\n                _this.$message.error(err.data.message);\n              });\n          } else {\n            let postBody = {};\n            postBody.list = list;\n            postBody.waybill_id = this.form.radio;\n            _this.$heshop\n              .orderhandle(\n                'post',\n                {\n                  behavior: 'waybill'\n                },\n                postBody\n              )\n              .then(() => {\n                _this.$message.success('操作成功');\n                _this.loading = false;\n                _this.getList();\n              })\n              .catch(err => {\n                console.error(err);\n                _this.loading = false;\n                _this.$message.error(err.data.message);\n              });\n          }\n\n          // 重写数据\n          if (this.form.type === 1) {\n            _this.$refs.upload.value = '';\n          } else {\n            _this.$refs.uploadWaybill.value = '';\n          }\n        } catch (e) {\n          _this.loading = false;\n          _this.$message.error('系统错误');\n        }\n      };\n      fileReader.readAsBinaryString(files[0]);\n    },\n    exportData: function (id) {\n      let _this = this;\n      this.loading = true;\n      this.$heshop\n        .orderhandle('get', id)\n        .then(res => {\n          let header = [];\n          if (res.error_data.length > 0 && res.error_data[0].length > 2) {\n            header = ['订单号', '物流公司', '物流单号', '失败描述'];\n          } else {\n            header = ['订单号', '失败描述'];\n          }\n          let data = res.error_data;\n          require.ensure([], function () {\n            _this.$h.Export2Excel.export_json_to_excel({\n              header,\n              data,\n              filename: name + '批量发货失败记录(' + _this.$moment(new Date()).format('YYYYMMDDHHmmss') + ')'\n            });\n            _this.loading = false;\n          });\n        })\n        .catch(function (err) {\n          _this.loading = false;\n          _this.$message.error(err.data.message);\n        });\n    },\n    changeRadio(e) {\n      console.log(e);\n      console.log(this.form);\n      if (e === 1) {\n        this.copyData = this.$_.cloneDeep(this.form);\n      }\n      if (e === 2) {\n        let _this = this;\n        this.$heshop\n          .search(\n            'post',\n            {\n              include: 'setting'\n            },\n            {\n              keyword: 'waybilljson'\n            }\n          )\n          .then(response => {\n            _this.express = response.map(item => {\n              return { value: item.name, label: item.name, code: item.code };\n            });\n            if (!this.$_.isEmpty(this.copyData)) {\n              this.form = this.$_.cloneDeep(this.copyData);\n              this.form.type = 2;\n            }\n          });\n      } else {\n        this.form.logistics_company = '';\n        this.form.radio = null;\n      }\n    },\n    getAddress() {\n      for (let i = 0; i < this.express.length; i++) {\n        if (this.express[i].value === this.form.logistics_company.trim()) {\n          this.form.code = this.express[i].code;\n        }\n      }\n      this.$heshop\n        .waybill('get', { behavior: 'option', code: this.form.code })\n        .then(res => {\n          this.addressList = res.data;\n          if (res.data.length > 0) {\n            this.form.radio = res.data[0].id;\n            res.data.forEach(v => {\n              if (v.status === 1) {\n                this.form.radio = v.id;\n              }\n            });\n          } else {\n            this.form.radio = null;\n          }\n        })\n        .catch(err => {\n          this.$message.error(err.data.message);\n        });\n    },\n    downloadFile() {\n      const a = document.createElement('a');\n      a.setAttribute('download', '批量发货模板.xlsx');\n      a.setAttribute('href', this.origin + '/static/files/bulk-shipping-template-waybill.xlsx');\n      a.click();\n    }\n  },\n  mounted() {\n    this.origin = window.location.origin;\n    this.getList();\n  }\n};\n</script>\n<style scoped lang=\"scss\">\n@import './bulkShipping.less';\n/deep/.le-table--operating__btn {\n  padding-left: 0;\n}\n</style>\n","import mod from \"-!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./bulkShipping.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./bulkShipping.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./bulkShipping.vue?vue&type=template&id=55d19524&scoped=true&\"\nimport script from \"./bulkShipping.vue?vue&type=script&lang=js&\"\nexport * from \"./bulkShipping.vue?vue&type=script&lang=js&\"\nimport style0 from \"./bulkShipping.vue?vue&type=style&index=0&id=55d19524&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"55d19524\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/_css-loader@3.6.0@css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/_sass-loader@7.3.1@sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./bulkShipping.vue?vue&type=style&index=0&id=55d19524&scoped=true&lang=scss&\""],"sourceRoot":""}
{"version":3,"sources":["webpack:///./src/features/coupon/send.vue?3728","webpack:///./src/features/coupon/send.vue?c3bd","webpack:///src/features/coupon/send.vue","webpack:///./src/features/coupon/send.vue?4ae9","webpack:///./src/features/coupon/send.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","_v","directives","name","rawName","value","expression","ref","rules","form","slot","_s","detail","over_num","expire_type","expire_day","_f","begin_time","end_time","_e","min_price","sub_price","nativeOn","$event","formatNum","apply","arguments","model","coupon_list","callback","$$v","$set","_n","item","user_list","modifiers","scopedSlots","_u","key","fn","scope","row","oauth","type","nickname","on","splice","$index","label","label_list","_l","index","stopPropagation","delLabel","disable","loading","submit","staticRenderFns","data","num","give_limit","methods","router","$router","replace","path","chooseUser","e","setLabel","$delete","_this","$refs","validate","valid","map","id","$heshop","getDetail","target","mounted","component"],"mappings":"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","file":"js/chunk-78240b9e.4a0f5d21.js","sourcesContent":["export * from \"-!../../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/_css-loader@3.6.0@css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/_sass-loader@7.3.1@sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./send.vue?vue&type=style&index=0&id=9cf9d992&scoped=true&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"le-matter\"},[_c('el-breadcrumb',{staticClass:\"he-link-text\",attrs:{\"separator-class\":\"el-icon-arrow-right\"}},[_c('el-breadcrumb-item',[_c('he-link',{attrs:{\"href\":\"plugins/features\"}},[_vm._v(\"营销玩法\")])],1),_c('el-breadcrumb-item',{staticClass:\"he-link\"},[_c('he-link',{attrs:{\"href\":\"features/coupon/index\"}},[_vm._v(\"优惠券管理\")])],1),_c('el-breadcrumb-item',[_vm._v(\" 发放优惠券 \")])],1),_c('el-form',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],ref:\"form\",staticClass:\"le-send\",attrs:{\"label-width\":\"193px\",\"rules\":_vm.rules,\"model\":_vm.form}},[_c('div',{staticClass:\"le-card\"},[_c('div',{staticClass:\"le-card-header flex align-center\"},[_c('span'),_c('span',[_vm._v(\"基本信息\")])]),_c('div',{staticClass:\"le-card-body\"},[_c('el-form-item',[_c('span',{staticClass:\"le-form-item__label\",attrs:{\"slot\":\"label\"},slot:\"label\"},[_vm._v(\"优惠券名称\")]),_c('span',{staticClass:\"le-form-item__text\"},[_vm._v(_vm._s(_vm.detail.name))])]),_c('el-form-item',[_c('span',{staticClass:\"le-form-item__label\",attrs:{\"slot\":\"label\"},slot:\"label\"},[_vm._v(\"剩余发放总量\")]),_c('span',{staticClass:\"le-form-item__text\"},[_vm._v(_vm._s(_vm.detail.over_num)+\"张\")])]),_c('el-form-item',[_c('span',{staticClass:\"le-form-item__label\",attrs:{\"slot\":\"label\"},slot:\"label\"},[_vm._v(\"用券时间\")]),(_vm.detail.expire_type === 1)?_c('span',{staticClass:\"le-form-item__text\"},[_vm._v(\"领券当日起\"+_vm._s(_vm.detail.expire_day)+\"天可用\")]):(_vm.detail.expire_type === 2)?_c('span',{staticClass:\"le-form-item__text\"},[_vm._v(_vm._s(_vm._f(\"timeFormat\")(_vm.detail.begin_time,'yyyy-mm-dd hh:MM:ss'))+\"~\"+_vm._s(_vm._f(\"timeFormat\")(_vm.detail.end_time,'yyyy-mm-dd hh:MM:ss')))]):_vm._e()]),_c('el-form-item',[_c('span',{staticClass:\"le-form-item__label\",attrs:{\"slot\":\"label\"},slot:\"label\"},[_vm._v(\"门槛金额\")]),_c('span',{staticClass:\"le-form-item__text\"},[_vm._v(_vm._s(_vm.detail.min_price === 0 || _vm.detail.min_price === null ? '无门槛' : _vm.detail.min_price + '元'))])]),_c('el-form-item',[_c('span',{staticClass:\"le-form-item__label\",attrs:{\"slot\":\"label\"},slot:\"label\"},[_vm._v(\"优惠金额\")]),_c('span',{staticClass:\"le-form-item__text\"},[_vm._v(_vm._s(_vm.detail.sub_price)+\"元\")])])],1)]),_c('div',{staticClass:\"le-card\"},[_c('div',{staticClass:\"le-card-header flex align-center\"},[_c('span'),_c('span',[_vm._v(\"发放优惠券\")])]),_c('div',{staticClass:\"le-card-body\"},[_c('el-form-item',{attrs:{\"prop\":\"coupon_list[0].num\"}},[_c('span',{staticClass:\"le-form-item__label\",attrs:{\"slot\":\"label\"},slot:\"label\"},[_vm._v(\"每人发放\")]),_c('el-input',{staticClass:\"le-form-item-small-input\",attrs:{\"maxlength\":6},nativeOn:{\"input\":function($event){return _vm.formatNum.apply(null, arguments)}},model:{value:(_vm.form.coupon_list[0].num),callback:function ($$v) {_vm.$set(_vm.form.coupon_list[0], \"num\", _vm._n($$v))},expression:\"form.coupon_list[0].num\"}},[_c('template',{slot:\"append\"},[_vm._v(\"张\")])],2)],1),_c('el-form-item',[_c('span',{staticClass:\"le-form-item__label\",attrs:{\"slot\":\"label\"},slot:\"label\"},[_vm._v(\"指定用户发放\")]),_c('el-button',{directives:[{name:\"popup\",rawName:\"v-popup.chooseUser\",value:({ item: _vm.form.user_list }),expression:\"{ item: form.user_list }\",modifiers:{\"chooseUser\":true}}],staticClass:\"le-btn\",attrs:{\"width\":\"577\",\"title\":\"选择用户\",\"module\":\"users\",\"action\":\"chooseUser\"}},[_vm._v(\"选择用户 \")]),(_vm.form.user_list.length)?_c('el-table',{staticClass:\"le-users-table\",attrs:{\"data\":_vm.form.user_list,\"max-height\":\"368px\",\"row-class-name\":\"le-table-row\"}},[_c('el-table-column',{attrs:{\"label\":\"用户ID\",\"width\":\"120\",\"prop\":\"id\"}}),_c('el-table-column',{attrs:{\"label\":\"用户昵称\",\"prop\":\"nickname\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [(scope.row.oauth.type === 'weapp')?_c('he-icon',{attrs:{\"size\":\"18px\",\"type\":\"le-icon-xiaochengxu\"}}):(scope.row.oauth.type === 'wechat')?_c('he-icon',{attrs:{\"size\":\"18px\",\"type\":\"le-icon-wehcat\"}}):_vm._e(),_vm._v(\" \"+_vm._s(scope.row.nickname)+\" \")]}}],null,false,685763140)}),_c('el-table-column',{attrs:{\"label\":\"操作\",\"width\":\"160\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('span',{staticClass:\"le-button-text\",on:{\"click\":function($event){return _vm.form.user_list.splice(scope.$index, 1)}}},[_vm._v(\"移除\")])]}}],null,false,3081881386)})],1):_vm._e()],1),_c('el-form-item',[_c('span',{staticClass:\"le-form-item__label\",attrs:{\"slot\":\"label\"},slot:\"label\"},[_vm._v(\"指定用户标签发放\")]),_c('el-button',{directives:[{name:\"popup\",rawName:\"v-popup.chooseLabel\",value:({ label: _vm.form.label_list }),expression:\"{ label: form.label_list }\",modifiers:{\"chooseLabel\":true}}],staticClass:\"le-btn\",attrs:{\"action\":\"setLabel\",\"module\":\"users\",\"title\":\"选择用户标签\",\"width\":\"704\"}},[_vm._v(\"选择用户标签 \")]),_c('div',{staticClass:\"le-user-label flex flex-wrap\"},_vm._l((_vm.form.label_list),function(item,index){return _c('div',{key:index,staticClass:\"le-tag\"},[_c('span',[_vm._v(_vm._s(item.name))]),_c('i',{staticClass:\"el-tag__close el-icon-close\",on:{\"click\":function($event){$event.stopPropagation();return _vm.delLabel(item, index)}}})])}),0)],1)],1)])]),(!_vm.disable)?_c('div',{staticClass:\"le-cardpin\"},[_c('el-button',{attrs:{\"type\":\"primary\",\"disabled\":_vm.loading,\"loading\":_vm.loading},on:{\"click\":function($event){return _vm.submit()}}},[_vm._v(\"提交\")])],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"le-matter\">\n    <el-breadcrumb class=\"he-link-text\" separator-class=\"el-icon-arrow-right\">\n      <el-breadcrumb-item>\n        <he-link href=\"plugins/features\">营销玩法</he-link>\n      </el-breadcrumb-item>\n      <el-breadcrumb-item class=\"he-link\">\n        <he-link href=\"features/coupon/index\">优惠券管理</he-link>\n      </el-breadcrumb-item>\n      <el-breadcrumb-item> 发放优惠券 </el-breadcrumb-item>\n    </el-breadcrumb>\n    <el-form label-width=\"193px\" ref=\"form\" class=\"le-send\" :rules=\"rules\" :model=\"form\" v-loading=\"loading\">\n      <div class=\"le-card\">\n        <div class=\"le-card-header flex align-center\">\n          <span></span>\n          <span>基本信息</span>\n        </div>\n        <div class=\"le-card-body\">\n          <el-form-item>\n            <span slot=\"label\" class=\"le-form-item__label\">优惠券名称</span>\n            <span class=\"le-form-item__text\">{{ detail.name }}</span>\n          </el-form-item>\n          <el-form-item>\n            <span slot=\"label\" class=\"le-form-item__label\">剩余发放总量</span>\n            <span class=\"le-form-item__text\">{{ detail.over_num }}张</span>\n          </el-form-item>\n          <el-form-item>\n            <span slot=\"label\" class=\"le-form-item__label\">用券时间</span>\n            <span class=\"le-form-item__text\" v-if=\"detail.expire_type === 1\"\n              >领券当日起{{ detail.expire_day }}天可用</span\n            >\n            <span class=\"le-form-item__text\" v-else-if=\"detail.expire_type === 2\"\n              >{{ detail.begin_time | timeFormat('yyyy-mm-dd hh:MM:ss') }}~{{\n                detail.end_time | timeFormat('yyyy-mm-dd hh:MM:ss')\n              }}</span\n            >\n          </el-form-item>\n          <el-form-item>\n            <span slot=\"label\" class=\"le-form-item__label\">门槛金额</span>\n            <span class=\"le-form-item__text\">{{\n              detail.min_price === 0 || detail.min_price === null ? '无门槛' : detail.min_price + '元'\n            }}</span>\n          </el-form-item>\n          <el-form-item>\n            <span slot=\"label\" class=\"le-form-item__label\">优惠金额</span>\n            <span class=\"le-form-item__text\">{{ detail.sub_price }}元</span>\n          </el-form-item>\n        </div>\n      </div>\n      <div class=\"le-card\">\n        <div class=\"le-card-header flex align-center\">\n          <span></span>\n          <span>发放优惠券</span>\n        </div>\n        <div class=\"le-card-body\">\n          <el-form-item prop=\"coupon_list[0].num\">\n            <span slot=\"label\" class=\"le-form-item__label\">每人发放</span>\n            <el-input\n              class=\"le-form-item-small-input\"\n              v-model.number=\"form.coupon_list[0].num\"\n              :maxlength=\"6\"\n              @input.native=\"formatNum\"\n            >\n              <template slot=\"append\">张</template>\n            </el-input>\n          </el-form-item>\n          <el-form-item>\n            <span slot=\"label\" class=\"le-form-item__label\">指定用户发放</span>\n            <el-button\n              class=\"le-btn\"\n              width=\"577\"\n              title=\"选择用户\"\n              module=\"users\"\n              v-popup.chooseUser=\"{ item: form.user_list }\"\n              action=\"chooseUser\"\n              >选择用户\n            </el-button>\n            <el-table\n              v-if=\"form.user_list.length\"\n              :data=\"form.user_list\"\n              class=\"le-users-table\"\n              max-height=\"368px\"\n              row-class-name=\"le-table-row\"\n            >\n              <el-table-column label=\"用户ID\" width=\"120\" prop=\"id\"></el-table-column>\n              <el-table-column label=\"用户昵称\" prop=\"nickname\">\n                <template slot-scope=\"scope\">\n                  <he-icon size=\"18px\" v-if=\"scope.row.oauth.type === 'weapp'\" type=\"le-icon-xiaochengxu\"></he-icon>\n                  <he-icon size=\"18px\" v-else-if=\"scope.row.oauth.type === 'wechat'\" type=\"le-icon-wehcat\"></he-icon>\n                  {{ scope.row.nickname }}\n                </template>\n              </el-table-column>\n              <el-table-column label=\"操作\" width=\"160\">\n                <template slot-scope=\"scope\">\n                  <span class=\"le-button-text\" @click=\"form.user_list.splice(scope.$index, 1)\">移除</span>\n                </template>\n              </el-table-column>\n            </el-table>\n          </el-form-item>\n          <el-form-item>\n            <span slot=\"label\" class=\"le-form-item__label\">指定用户标签发放</span>\n            <el-button\n              class=\"le-btn\"\n              action=\"setLabel\"\n              module=\"users\"\n              title=\"选择用户标签\"\n              width=\"704\"\n              v-popup.chooseLabel=\"{ label: form.label_list }\"\n              >选择用户标签\n            </el-button>\n            <div class=\"le-user-label flex flex-wrap\">\n              <div class=\"le-tag\" v-for=\"(item, index) in form.label_list\" :key=\"index\">\n                <span>{{ item.name }}</span>\n                <i class=\"el-tag__close el-icon-close\" @click.stop=\"delLabel(item, index)\"></i>\n              </div>\n            </div>\n          </el-form-item>\n        </div>\n      </div>\n    </el-form>\n    <div class=\"le-cardpin\" v-if=\"!disable\">\n      <el-button type=\"primary\" :disabled=\"loading\" :loading=\"loading\" @click=\"submit()\">提交</el-button>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'send',\n  data() {\n    return {\n      loading: true,\n      disable: false,\n      form: {\n        num: 1,\n        user_list: [],\n        label_list: [],\n        coupon_list: [\n          {\n            num: 1,\n            id: parseInt(this.$route.query.id)\n          }\n        ]\n      },\n      detail: {\n        name: '优惠券名称',\n        over_num: 1,\n        begin_time: null,\n        give_limit: null,\n        sub_price: 0\n      },\n      rules: {\n        'coupon_list[0].num': [\n          {\n            required: true,\n            message: '请输入每人发放张数',\n            trigger: 'blur'\n          }\n        ]\n      }\n    };\n  },\n  methods: {\n    router: function (path) {\n      this.$router.replace({\n        path: path\n      });\n    },\n    chooseUser: function (e) {\n      this.form.user_list = e.item;\n    },\n    setLabel: function (data) {\n      this.form.label_list = data.label;\n    },\n    delLabel: function (item, index) {\n      this.$delete(this.form.label_list, index);\n    },\n    submit: function () {\n      let _this = this;\n      _this.loading = true;\n      _this.$refs['form'].validate(valid => {\n        if (valid) {\n          let form = JSON.parse(JSON.stringify(_this.form));\n          form.label_list = form.label_list.map(function (item) {\n            return item.id;\n          });\n          form.user_list = form.user_list.map(function (item) {\n            return item.id;\n          });\n          _this.$heshop\n            .coupon(\n              'post',\n              {\n                behavior: 'send'\n              },\n              form\n            )\n            .then(function (response) {\n              setTimeout(function () {\n                _this.detail.over_num = _this.detail.over_num - response[0].length;\n                _this.$message.success('发放成功');\n                _this.loading = false;\n              }, 3000);\n            })\n            .catch(function (error) {\n              _this.loading = false;\n              if (error.status === 403) {\n                const h = _this.$createElement;\n                let arr = error.data.message.split('---------');\n                console.log(arr.length);\n                let str = '';\n                if (arr.length > 1) {\n                  str = arr[1];\n                } else {\n                  str = arr[0];\n                }\n                _this.$confirm('提示', {\n                  confirmButtonText: '我知道了',\n                  showCancelButton: false,\n                  message: h('div', null, [\n                    h(\n                      'p',\n                      {\n                        class: 'le-text-algin le-confirm-line'\n                      },\n                      [\n                        h('span', {\n                          class: 'el-icon-warning le-warning-icon'\n                        }),\n                        h(\n                          'span',\n                          {\n                            class: 'le-confirm-title'\n                          },\n                          '发放失败'\n                        )\n                      ]\n                    ),\n                    h(\n                      'p',\n                      {\n                        class: 'le-text-algin le-confirm-tip'\n                      },\n                      str\n                    )\n                  ])\n                });\n              } else {\n                _this.$message.error(error.data.message);\n              }\n            });\n        } else {\n          this.loading = false;\n        }\n      });\n    },\n    getDetail: function () {\n      let _this = this;\n      this.$heshop\n        .coupon('get', parseInt(this.$route.query.id))\n        .then(function (response) {\n          _this.loading = false;\n          if (response.status === 0) {\n            _this.disable = true;\n            _this.$message.error('优惠券已下架');\n          } else if (response.status === 2) {\n            _this.disable = true;\n            _this.$message.error('优惠券已失效');\n          }\n          _this.detail = response;\n        })\n        .catch(function (error) {\n          _this.loading = false;\n          _this.$message.error(error.data.message);\n        });\n    },\n    formatNum: function (e) {\n      e.target.value = e.target.value.replace(/[^\\d.]/g, '');\n      e.target.value = e.target.value.replace(/^0[^\\.]+/g, '0');\n    }\n  },\n  mounted() {\n    this.getDetail();\n  }\n};\n</script>\n\n<style scoped lang=\"scss\">\n@import './css/send.less';\n</style>\n","import mod from \"-!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./send.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./send.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./send.vue?vue&type=template&id=9cf9d992&scoped=true&\"\nimport script from \"./send.vue?vue&type=script&lang=js&\"\nexport * from \"./send.vue?vue&type=script&lang=js&\"\nimport style0 from \"./send.vue?vue&type=style&index=0&id=9cf9d992&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/_vue-loader@15.9.6@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"9cf9d992\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}